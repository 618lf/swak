(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-391b"],{1562:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tax-page tempate"},[a("h4",[t._v("报表计税")]),a("div",{staticClass:"content"},[a("div",{staticClass:"options"},[a("span",[t._v("提供报表计税服务：点击“计算”按钮，导入需要计算的报表数据，计算好之后点击下载可以导出计算结果")]),a("div",{staticClass:"btns"},[a("el-button",{attrs:{type:"primary"},on:{click:t.openUpload}},[t._v("设置计算任务")])],1)]),a("table",{staticClass:"table sample-table table-bordered table-hover"},[t._m(0),a("tbody",[t._l(t.reports,function(e){return a("tr",{key:e.id},[a("td",[t._v(t._s(e.name)+" - "+t._s(e.createDate)),a("span",{staticClass:"td-tip"},[t._v(t._s(e.apiName))])]),a("td",{staticClass:"td-ops"},[2==e.state?a("a",{attrs:{"data-id":e.id},on:{click:function(e){return e.stopPropagation(),t.download(e)}}},[t._v("下载")]):t._e(),a("a",{attrs:{"data-id":e.id},on:{click:function(e){return e.stopPropagation(),t.doCalculate(e)}}},[t._v("计算")])])])}),0==t.reports.length?a("tr",[a("td",{staticClass:"td-none",attrs:{colspan:"2"}},[t._v("还没设置计算任务")])]):t._e()],2)])]),a("multi-upload",{attrs:{visible:t.multipartFile.visible,file:t.multipartFile},on:{"update:visible":function(e){t.$set(t.multipartFile,"visible",e)},"multiFile:update":t.uploadSuccess}})],1)},l=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{attrs:{scope:"col"}},[t._v("计算任务")]),a("th",{attrs:{scope:"col",width:"80"}},[t._v("计算结果")])])])}],s=(a("7f7f"),a("e1d2")),o={list:function(t){return Object(s["a"])({url:"/api/user/reportcal/list/"+t,method:"get"})},xml:function(t){return Object(s["a"])({url:"/api/user/reportcal/xml",method:"post",responseType:"blob",data:{id:t}})},cal:function(t){return Object(s["a"])({url:"/api/user/reportcal/cal",method:"post",data:{id:t}})}},n=o,c=a("b0fa"),r=a("882d"),d={components:{SwakLink:r["a"],MultiUpload:c["a"]},name:"calculate",data:function(){return{type:"COMPUTE_TAX",reports:[],shows:!1,multipartFile:{loading:!1,visible:!1,accept:".xml",action:"/api/user/reportcal/save?apiIdent=COMPUTE_TAX",template:""},downloadFile:{loading:!1,visible:!1}}},mounted:function(){this.$emit("layout:load","calculate"),this.loadData()},methods:{loadData:function(){var t=this;n.list(this.type).then(function(e){t.reports=e.obj})},openUpload:function(){this.multipartFile.loading=!0,this.multipartFile.visible=!0},uploadSuccess:function(){this.loadData()},doCalculate:function(t){var e=this,a=t.currentTarget.getAttribute("data-id");n.cal(a).then(function(){e.$notify.success("计算成功")})},download:function(t){var e=this,a=t.currentTarget.getAttribute("data-id");this.downloadFile.visible=!0,n.xml(a).then(function(t){e.downloadFile.visible=!1,e.downloadFile.name=decodeURI(t.fileName),e.downloadFile.data=t.data,e.doDownload()},function(){e.$notify.error("error!")})},doDownload:function(){var t=window.URL.createObjectURL(new Blob([this.downloadFile.data])),e=document.createElement("a");e.style.display="none",e.href=t,e.setAttribute("download",this.downloadFile.name),document.body.appendChild(e),e.click()}}},u=d,p=(a("788c"),a("2877")),f=Object(p["a"])(u,i,l,!1,null,"34243626",null);f.options.__file="calculate.vue";e["default"]=f.exports},"256c":function(t,e,a){},"788c":function(t,e,a){"use strict";var i=a("c33f"),l=a.n(i);l.a},b0fa:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"user-table-select"},[a("el-dialog",{attrs:{title:"文件上传",visible:t.visible,"before-close":t.doCancel},on:{"update:visible":function(e){t.visible=e}}},[a("div",{staticClass:"multi-file"},[a("el-upload",{staticClass:"upload-demo",attrs:{drag:"",accept:t.file.accept,action:t.action,headers:t.headers,data:t.params,"on-success":t.doSuccess}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),a("em",[t._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传"+t._s(t.file.accept)+"文件")])])],1)])],1)},l=[],s=a("8c89"),o={name:"multi-upload",props:{visible:{type:Boolean,default:!1},file:{type:Object,default:null}},computed:{action:function(){return s["a"].VUE_APP_BASE_URL+this.file.action},headers:function(){return{"X-Token":this.$store.getters.token}},params:function(){return{template:this.file.template}}},methods:{doCancel:function(){this.$emit("update:visible",!1)},doSuccess:function(t){t.success?(this.$notify.success("上传成功"),this.$emit("multiFile:update",!1)):this.$notify.error(t.msg)}}},n=o,c=(a("ff56"),a("2877")),r=Object(c["a"])(n,i,l,!1,null,"aaa0291a",null);r.options.__file="multiFile.vue";e["a"]=r.exports},c33f:function(t,e,a){},ff56:function(t,e,a){"use strict";var i=a("256c"),l=a.n(i);l.a}}]);
//# sourceMappingURL=chunk-391b.e09b22d7.js.map